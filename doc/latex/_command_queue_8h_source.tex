\doxysection{Command\+Queue.\+h}
\hypertarget{_command_queue_8h_source}{}\label{_command_queue_8h_source}\index{src/CommandQueue.h@{src/CommandQueue.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <DirectX-\/Headers/include/directx/d3dx12.h>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <wrl.h>}\ \ \ \ \textcolor{comment}{//\ For\ Microsoft::WRL::ComPtr}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <cstdint>}\ \ \textcolor{comment}{//\ For\ uint64\_t}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <queue>}\ \ \ \ \textcolor{comment}{//\ For\ std::queue}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{keyword}{class\ }CommandQueue}
\DoxyCodeLine{00014\ \{}
\DoxyCodeLine{00015\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00016\ \ \ \ \ CommandQueue(Microsoft::WRL::ComPtr<ID3D12Device2>\ \&device,\ D3D12\_COMMAND\_LIST\_TYPE\ type);}
\DoxyCodeLine{00017\ \ \ \ \ \textcolor{keyword}{virtual}\ \string~CommandQueue();}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \ \ \ \ \textcolor{comment}{//\ Get\ an\ available\ command\ list\ from\ the\ command\ queue.}}
\DoxyCodeLine{00020\ \ \ \ \ Microsoft::WRL::ComPtr<ID3D12GraphicsCommandList2>\ GetCommandList();}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \ \ \ \ \textcolor{comment}{//\ Execute\ a\ command\ list.}}
\DoxyCodeLine{00023\ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ fence\ value\ to\ wait\ for\ for\ this\ command\ list.}}
\DoxyCodeLine{00024\ \ \ \ \ uint64\_t\ ExecuteCommandList(Microsoft::WRL::ComPtr<ID3D12GraphicsCommandList2>\ commandList);}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \ \ \ \ uint64\_t\ Signal();}
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keywordtype}{bool}\ IsFenceComplete(uint64\_t\ fenceValue);}
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{keywordtype}{void}\ WaitForFenceValue(uint64\_t\ fenceValue);}
\DoxyCodeLine{00029\ \ \ \ \ \textcolor{keywordtype}{void}\ Flush();}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \ \ \ \ Microsoft::WRL::ComPtr<ID3D12CommandQueue>\ GetD3D12CommandQueue()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00032\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \ \ \ \ Microsoft::WRL::ComPtr<ID3D12CommandAllocator>\ CreateCommandAllocator();}
\DoxyCodeLine{00035\ \ \ \ \ Microsoft::WRL::ComPtr<ID3D12GraphicsCommandList2>\ CreateCommandList(Microsoft::WRL::ComPtr<ID3D12CommandAllocator>\ allocator);}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{comment}{//\ Keep\ track\ of\ command\ allocators\ that\ are\ "{}in-\/flight"{}}}
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keyword}{struct\ }CommandAllocatorEntry}
\DoxyCodeLine{00040\ \ \ \ \ \{}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ uint64\_t\ fenceValue;}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ Microsoft::WRL::ComPtr<ID3D12CommandAllocator>\ commandAllocator;}
\DoxyCodeLine{00043\ \ \ \ \ \};}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{keyword}{using\ }CommandAllocatorQueue\ =\ std::queue<CommandAllocatorEntry>;}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keyword}{using\ }CommandListQueue\ =\ std::queue<\ Microsoft::WRL::ComPtr<ID3D12GraphicsCommandList2>\ >;}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \ \ D3D12\_COMMAND\_LIST\_TYPE\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_CommandListType;}
\DoxyCodeLine{00049\ \ \ \ \ Microsoft::WRL::ComPtr<ID3D12Device2>\ \ \ \ \ \ \ m\_d3d12Device;}
\DoxyCodeLine{00050\ \ \ \ \ Microsoft::WRL::ComPtr<ID3D12CommandQueue>\ \ m\_d3d12CommandQueue;}
\DoxyCodeLine{00051\ \ \ \ \ Microsoft::WRL::ComPtr<ID3D12Fence>\ \ \ \ \ \ \ \ \ m\_d3d12Fence;}
\DoxyCodeLine{00052\ \ \ \ \ HANDLE\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_FenceEvent;}
\DoxyCodeLine{00053\ \ \ \ \ uint64\_t\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_FenceValue;}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \ \ CommandAllocatorQueue\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_CommandAllocatorQueue;}
\DoxyCodeLine{00056\ \ \ \ \ CommandListQueue\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_CommandListQueue;}
\DoxyCodeLine{00057\ \};}

\end{DoxyCode}
